<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>CloudWatch - Easy way to measure AWS services latency from your browser!</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="CloudWatch is a service that can be used to measure the latency of AWS services like EC2, SimpleDB, S3 etc">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
      }
    </style>
    <link href="css/bootstrap-responsive.min.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="../assets/ico/favicon.ico">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript">
      
     //Initialize all EC2 API ends for different regions which will be used to measure the latency
      var ec2 = {
         va: "ec2.us-east-1.amazonaws.com",
         ca: "ec2.us-west-1.amazonaws.com",
         sgp: "ec2.ap-southeast-1.amazonaws.com",
         og: "ec2.us-west-2.amazonaws.com",
         sp: "ec2.sa-east-1.amazonaws.com",
         eu: "ec2.eu-west-1.amazonaws.com",
         tk: "ec2.ap-northeast-1.amazonaws.com"

      };


    $(document).ready(function(){

      $("#btnLatency").click( function () { 
        // get all regions data from the table elements
        var regions = $(".awsregion").toArray();
        // create a request for each region
        generateAWSAPIRequest(regions);

      });

    });

   
  </script>
  

    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-33429218-1']);
      _gaq.push(['_setDomainName', 'cloudwatch.in']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>

  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="#">CloudWatch</a>
          <div class="nav-collapse">
            <ul class="nav">
              <li class="active"><a href="#">Home</a></li>
              <li><a href="http://www.minjar.com/" target="_blank">About</a></li>
              <li><a href="mailto:amnigos@gmail.com">Contact</a></li>
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="row offset10"> 
      <p>
      It's <a href="http://aws.typepad.com/aws/2011/02/host-your-static-website-on-amazon-s3.html" target="_blank">hosted on S3</a> and add your awesomeness <a href="https://github.com/amnigos/CloudWatch" target="_blank">on GitHub</a>.
    </p>
    </div>

    <div class="container">

    <div class="row">
    <h3 class="span12">Measure Amazon ElasticCloudCompute(EC2) Latency From Your Browser!</h3>
    </div>
    <div class="row">
     <p class="span12"/>
    <p class="span12">Amazon Cloud is available in multiple regions and this tool will help you measure the latency from your browser to different regions. Click on the check latency button below to get started.</p>
    
    </div>
   <p class="span12"/>
   <p class="span12"/>
   <p class="span12"/>
   <p class="span12"/>


  <div class="row"> 
    <table class="table table-bordered span4">
    <thead>
    <tr>
    <th class="label label-info">AWS Region</th>
    <th class="label label-info">HTTP Ping</th>
    </tr>
    </thead>
    <tbody>
    <tr>
    <td>N. Virginia</td>
    <td class="awsregion" id="va"><label/></td>
    </tr>
     <tr>
    <td>Oregon</td>
    <td class="awsregion" id="og"><label/></td>
    </tr>
     <tr>
    <td>N. California</td>
    <td  class="awsregion" id="ca"><label/></td>
    </tr>
     <tr>
    <td>Ireland</td>
    <td  class="awsregion" id="eu"><label/></td>
    </tr>
     <tr>
    <td>Singapore</td>
    <td  class="awsregion" id="sgp"><label/></td>
    </tr>
     <tr>
    <td>Tokyo</td>
    <td  class="awsregion" id="tk"><label/></td>
    </tr>
     <tr>
       
    <td>SÃ£o Paulo</td>
    <td  class="awsregion" id="sp"><label/></td>
    </tr>
    </tbody>
    </table>
   </div>
   <div class="row">
    <div class="span2 offset1">
    
      <p id='awsapirequest'></p>
      <button type="submit" id="btnLatency" class="btn btn-success btn-large">Check Latency</button>
    
    </div>
  </div>
 
  <p class="span12"/>
  <p class="span12"/>
  <p class="span12"/>
  <p class="span12"/>
 <hr>

 <div class="row">
  <h2 class="span12">Frequently Asked Questions</h2>
 </div>
    <p class="span12"/>
    <p class="span12"/>
    <div class="row">
    <h3 class="span12">How reliable are above latency measurements?</h3>
    </div>
    <div class="row">
     <p class="span12"/>
     <p class="span12">They are not very reliable. However you should be looking at the relative value of the observed latencies for each AWS region to identify which are best AWS regions for your location. That should give you fairly good idea!</p>
    </div>
 
    <p class="span12"/>
    <div class="row">
    <h3 class="span12">How are you measuring the HTTP Ping Request Latency?</h3>
    </div>
    <div class="row">
     <p class="span12"/>
     <p class="span12"> We are making a HTTP GET request to AWS Service Endpoints (like EC2, SQS, SNS etc) for PING and measuring the observed latency for it across all regions.</p>
    </div>
 

 

   
 <hr>
    <footer>
        <p>&copy; Minajr 2012</p>
    </footer>


    </div> <!-- /container -->

    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="js/bootstrap.min.js"></script>
     
     <script type="text/javascript">
      // Generate AWS EC2 API request for each Amazon region
    function generateAWSAPIRequest(regions) {

          var region = regions.pop();
          if (region) {
              var regionName = region.id;
              var endpoint = ec2[regionName];
               $('#'+regionName).html('connecting..');
              executeAWSAPIRequest(endpoint, function(){ displayHTTPPingLatency(regionName, regions); });
          }

    }

    // Display the observed HTTP request/response latency for each region
    function displayHTTPPingLatency( regionName, regions) {

      var endTime = getCurrentTimeStamp();
      
      var latencyTime = endTime-window.startTime;
      
      $('#'+regionName).html(latencyTime.toString()+"ms");

      generateAWSAPIRequest(regions);

    }

    // Execute AWS API request for given end point
    function executeAWSAPIRequest(endpoint, onComplete) {

      var apirequest = $("#awsapirequest");
      // Cache burst issues? - EC2 doesn't allow adding any parameters to /ping call
      var endPointURL = "http://"+endpoint + "/ping";
      apirequest.empty();
      apirequest.html("<img id='apiresponse' style='display: none'>");
      var pingData = $("#apiresponse");
      pingData.error(onComplete); // Since we are loading http text data into image src, it will execute onError handler.
      window.startTime = getCurrentTimeStamp(); // global variable startTime is initialized
      pingData.attr("src", endPointURL);
  }


function getCurrentTimeStamp() {
    return (new Date()).getTime();
}

</script>

  </body>
</html>
